{

    "$schema": "http://json-schema.org/draft-04/schema#",
    "description": "Schema for an xAPI Object Activity",
    "id":"http://localhost:8080/object-activity-schema.json",

    "type": "object",

    "additionalProperties": false,
    "required": [ "id" ],
    "properties": {
        "objectType": {
            "type": "string",
            "pattern": "Activity"
        },
        "id": { "$ref": "#/definitions/iri" },
        "definition": { "$ref": "#/definitions/activity-definition" }
    },

    "definitions": {

        "activity-definition": {
            "type": "object",
            "properties": {
                "name": { "$ref": "#/definitions/lang-map" },
                "description": { "$ref": "#/definitions/lang-map" },
                "type": { "$ref": "#/definitions/iri" },
                "moreInfo": { "$ref": "#/definitions/iri" },
                "interactionType": {
                    "enum": [
                        "true-false",
                        "choice",
                        "fill-in",
                        "long-fill-in",
                        "matching",
                        "performance",
                        "sequencing",
                        "likert",
                        "numeric",
                        "other"
                    ]
                },
                "correctResponsesPattern": {
                    "type": "array",
                    "items": { "type": "string" }
                },
                "choices": {
                    "type": "array",
                    "items": { "$ref": "#/definitions/interactionComponent" }
                },
                "scale": {
                    "type": "array",
                    "items": { "$ref": "#/definitions/interactionComponent" }
                },
                "source": {
                    "type": "array",
                    "items": { "$ref": "#/definitions/interactionComponent" }
                },
                "target": {
                    "type": "array",
                    "items": { "$ref": "#/definitions/interactionComponent" }
                },
                "steps": {
                    "type": "array",
                    "items": { "$ref": "#/definitions/interactionComponent" }
                },
                "extensions": {
                    "type": "object",
                    "patternProperties": {
                        "^[\\S]+:\\/?\\/?(?!\\/)[\\S]+$": { "oneOf": [ {"type": "string"}, {"type":"number"}, {"type":"object"}, {"type":"array"}, {"type":"boolean"} ] }
                    },
                    "additionalProperties": false
                }
            },
            "additionalProperties": false
        },
        "interactionComponent": {
            "type": "object",
            "properties": {
                "id": { "type": "string" },
                "description": { "$ref": "#/definitions/lang-map" }
            },
            "required": [ "id" ],
            "additionalProperties": false
        },
        "iri": {
            "type": "string",
            "pattern": "^[\\S]+:\\/?\\/?(?!\\/)[\\S]+$"
        },
        "lang-map": {
            "type": "object",
            "patternProperties": {
                "^[a-z]{2,3}(?:-[A-Z]{2,3}(?:-[a-zA-Z]{4})?)?$": { "type": "string" }
            },
            "additionalProperties": false
        }
    }
}
